#!/usr/bin/env node

var opts = require('nomnom').parse();

var sourcemaps = opts.sourcemaps, 
	file = opts[0],
	fs = require('fs'),
	path = require('path'),
	sweet = require('sweet.js');

var macro = fs.readFileSync(path.join(__dirname,'../macro.js'), 'utf8');

if(!file) {
	throw new Error('usage: oia <file>')
}

var src = fs.readFileSync(path.join(file), 'utf8');

var code = sweet.compile(src, {
	modules: [sweet.loadModule(macro)]
}).code;

process.stdout.write(code + '\n')
